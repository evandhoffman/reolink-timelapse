services:
  timelapse:
    build: .
    env_file: .env
    volumes:
      # Frames and videos persist on the host under ./data/
      - ./data:/data
    restart: on-failure
    # Give the container 30 s to logout from the NVR before Docker sends SIGKILL.
    # Without this, a `docker compose down` kills the process before the logout
    # HTTP request completes, leaving a stale session on the NVR.
    stop_grace_period: 30s
    # Default: capture.  Override for stitch:
    #   docker compose run timelapse stitch --every-n-frames 4 --fps 24
